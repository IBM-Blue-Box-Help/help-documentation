<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Setting up OpenVPN server on your instance</title>
  <meta name="description" content="Quando precisar conectar às instâncias internas do Bluemix Private Cloud, mas você não tiver os endereços IP flutuantes disponíveis ou preferir não colocar e...">

  <link rel="stylesheet" href="/bluebox/help-documentation/css/main.css">
  <link rel="canonical" href="/bluebox/help-documentation/pt_BR/gettingstarted/commontech/openvpn-setup/">
  <link rel="alternate" type="application/rss+xml" title="Blue Box Help" href="/bluebox/help-documentation/pt_BR/feed.xml">
  
  <style>
   .site-header img:first-child {
       height: 72px;
}
</style>
  
</head>


  <body>

  
    <header class="site-header">

  <div class="header-wrapper">

    <a class="site-title" href="/bluebox/help-documentation/pt_BR/"><img src="/bluebox/help-documentation/img/pt_BR/Bluemix-logo-UI.svg" alt="" height="72px"></a>

    <div class="search--pageview">

  <div class="full-view__search hide">
    <a href="" class="x hide">X</a>
    <ul id="results-container"></ul>
    <ul class="results--container"></ul>

  </div>
  <div class="input-container">
    <label for="search__fullview" class="hide search--label">Search IBM Bluemix Private Cloud Help</label>
    <input type="text" id="search-input" placeholder="" name="search" class="search__minview--page">
    <img src="/bluebox/help-documentation/img/pt_BR/search.svg" class="search-icon" />
  </div>
</div>


    <a href="mailto:llundquist@us.ibm.com" class="header--request">
      <p>
        Submit A Request
      </p>
      <img src="/bluebox/help-documentation/img/pt_BR/user.svg">
    </a>
    <a id="nav-toggle" href="#"><span></span></a>

    <div>
  
    
      <a  href=" /bluebox/help-documentation/gettingstarted/commontech/openvpn-setup/ ">en</a> |
    
      <a  href=" /bluebox/help-documentation/fr/gettingstarted/commontech/openvpn-setup/ ">fr</a> |
    
      <a  href=" /bluebox/help-documentation/de/gettingstarted/commontech/openvpn-setup/ ">de</a> |
    
      <a  href=" /bluebox/help-documentation/ja/gettingstarted/commontech/openvpn-setup/ ">ja</a> |
    
      <a  href=" /bluebox/help-documentation/zh_CN/gettingstarted/commontech/openvpn-setup/ ">zh_CN</a> |
    
      <a  href=" /bluebox/help-documentation/zh_TW/gettingstarted/commontech/openvpn-setup/ ">zh_TW</a> |
    
      <a style="font-weight: bold;" href=" /bluebox/help-documentation/pt_BR/gettingstarted/commontech/openvpn-setup/ ">pt_BR</a> |
    
  
</div>

  </div>

</header>

  

  
  <div class="page-content">
  

      <div class="main-wrapper">
        
<div class="sidebar sidebar--toggled">
  <ul class="sidebar__nav">
    <li>
      <h3 class="title">
        
        
        
        <a  class="page-link"  href="/bluebox/help-documentation/pt_BR/gettingstarted">Getting Started (38)</a>
        <a href=""  class="expand rotate" ><img src="/bluebox/help-documentation/img/pt_BR/arrow.svg" /></a>
      </h3>
      <ul  class="article__list" >
        <h5 class="sub__head">Common Technical Questions</h5>
        
        
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/gettingstarted/commontech/connect-to-openvpn-server/">Connecting to your OpenVPN server</a>
          </li>
          
        
          
          <li>
              <a class="page-link--active"  href="/bluebox/help-documentation/pt_BR/gettingstarted/commontech/openvpn-setup/">Setting up OpenVPN server on your instance</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/gettingstarted/commontech/blue-box-cloud-components/">Bluemix Private Cloud Components</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/gettingstarted/commontech/detaching-volume/">What Should I Do Prior to Detaching a Volume?</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/gettingstarted/commontech/FAQ/">Technical FAQ</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/gettingstarted/commontech/python-environment-primer/">Virtual python environments and you: A developer's primer</a>
          </li>
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/gettingstarted/commontech/RHOSP_Product_Overview/">IBM Bluemix Private Cloud with Red Hat - Product Overview</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/gettingstarted/commontech/general_product_overview/">General Product Overview</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/gettingstarted/commontech/RHOSP_Building_Blocks/">Building Blocks for IBM Bluemix Private Cloud with Red Hat</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/gettingstarted/commontech/Building_Blocks/">IBM Bluemix Private Cloud Building Blocks (Community Edition)</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/gettingstarted/commontech/Instance_Resize/">Resizing an Instance (Non-live)</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/gettingstarted/commontech/Connecting_Clouds_with_SoftLayer/">Set Up Network Connectivity Between Multiple Cloud Environments, Using the Private Network</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/gettingstarted/commontech/Windows_License_Activation/">Customer Guide for Windows Activation</a>
              </li>
            
          
        
        <li><a href="" class="page-link view">View More ( 7 )</a></li>
      </ul>
      
      <ul  class="article__list" >
        <h5 class="sub__head">Common Administrative Questions</h5>
        
        
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/gettingstarted/commonadmin/view-my-bill/">How do I view my bill?</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/gettingstarted/commonadmin/adding-removing-subscribers/">Adding or removing subscribers to a ticket</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/gettingstarted/commonadmin/report-issue/">How do I report an issue?</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/gettingstarted/commonadmin/escalating-a-ticket/">How do I escalate a ticket?</a>
          </li>
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/gettingstarted/commonadmin/status-pages/">Bluemix Private Cloud Status Pages</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/gettingstarted/commonadmin/Transferring_A_Domain_From_Blue_Box/">Transferring A Domain From Blue Box</a>
              </li>
            
          
        
        <li><a href="" class="page-link view">View More ( 2 )</a></li>
      </ul>
      
      <ul  class="article__list" >
        <h5 class="sub__head">User Guides</h5>
        
        
          
             
         
             
         
             
         
             
                
                  
                  <li class="hidden non-featured">
                    <a class="page-link" href="/bluebox/help-documentation/pt_BR/gettingstarted/userguides/Box_Panel/">Box Panel User Guide</a>
                  </li>
              
             
         
             
                <li>
                <a class="page-link" href="/bluebox/help-documentation/pt_BR/gettingstarted/userguides/Eternal_Blue-ish_Triangle/">Box Panel, Site Controller, and IBM Bluemix Private Cloud Local</a>
                </li>
              
         
             
                <li>
                <a class="page-link" href="/bluebox/help-documentation/pt_BR/gettingstarted/userguides/qemu_article/">Building Up to OpenStack — QEMU and Your Cloud</a>
                </li>
              
         
             
                <li>
                <a class="page-link" href="/bluebox/help-documentation/pt_BR/gettingstarted/userguides/Improving_Cloud_Performance/">Building Up to OpenStack II -- Improving Cloud Performance</a>
                </li>
              
         
             
                <li>
                <a class="page-link" href="/bluebox/help-documentation/pt_BR/gettingstarted/userguides/Optimized_Load_Balancing/">Cloud 101 -- Optimized Load Balancing</a>
                </li>
              
         
             
                
                  
                  <li class="hidden non-featured">
                    <a class="page-link" href="/bluebox/help-documentation/pt_BR/gettingstarted/userguides/Cloud_Images_Provided_by_IBM/">User's Guide to Cloud Images (Community Edition)</a>
                  </li>
              
             
         
             
                
                  
                  <li class="hidden non-featured">
                    <a class="page-link" href="/bluebox/help-documentation/pt_BR/gettingstarted/userguides/Cloud_Images_Provided_RHOSP/">User's Guide to Cloud Images (IBM Bluemix Private Cloud with Red Hat)</a>
                  </li>
              
             
         
             
         
             
         
             
         
             
         
             
                
                  
                  <li class="hidden non-featured">
                    <a class="page-link" href="/bluebox/help-documentation/pt_BR/gettingstarted/userguides/Image_Release_Notes/">IBM Bluemix Private Cloud Image Release Notes</a>
                  </li>
              
             
         
        <li><a href="" class="page-link view">View More ( 4 )</a></li>
      </ul>
      
      <ul  class="article__list" >
        <h5 class="sub__head">Release Notes</h5>
        
        
          
             
                
                  
                  <li class="hidden non-featured">
                    <a class="page-link" href="/bluebox/help-documentation/pt_BR/releasenotes/Customer_3.1.1_Point_Release/">Customer 3.1.1 Point Release Notes</a>
                  </li>
              
             
         
             
                
                  
                  <li class="hidden non-featured">
                    <a class="page-link" href="/bluebox/help-documentation/pt_BR/releasenotes/Customer_3.0.1_Point_Release/">Customer 3.0.1 Point Release Notes</a>
                  </li>
              
             
         
             
                
                  
                  <li class="hidden non-featured">
                    <a class="page-link" href="/bluebox/help-documentation/pt_BR/releasenotes/Customer_4.0.0.0c_Release_Notes/">Release Notes 4.0.0.0c</a>
                  </li>
              
             
         
             
                <li>
                <a class="page-link" href="/bluebox/help-documentation/pt_BR/releasenotes/Customer_2.1.1_Point_Release/">Release Notes 2.1.1</a>
                </li>
              
         
             
                
                  
                  <li class="hidden non-featured">
                    <a class="page-link" href="/bluebox/help-documentation/pt_BR/releasenotes/Customer_3.1.0_Release_Notes/">Release Notes 3.1.0</a>
                  </li>
              
             
         
             
                
                  
                  <li class="hidden non-featured">
                    <a class="page-link" href="/bluebox/help-documentation/pt_BR/releasenotes/Customer_3.0.0_Release_Notes/">Release Notes 3.0.0</a>
                  </li>
              
             
         
             
                <li>
                <a class="page-link" href="/bluebox/help-documentation/pt_BR/releasenotes/Customer_4.0.0.0r_Release_Notes/">Release Notes 4.0.0.0r</a>
                </li>
              
         
             
                
                  
                  <li class="hidden non-featured">
                    <a class="page-link" href="/bluebox/help-documentation/pt_BR/releasenotes/release_notes_2.1_for_customers/">Release Notes 2.1</a>
                  </li>
              
             
         
        <li><a href="" class="page-link view">View More ( 6 )</a></li>
      </ul>
    </li>
    <li>
      <h3 class="title">
        <a  class="page-link"  href="/bluebox/help-documentation/pt_BR/troubleshooting">Troubleshooting (19)</a>
        <a href=""  class="expand rotate" ><img src="/bluebox/help-documentation/img/pt_BR/arrow.svg" /></a>
      </h3>
      <ul  class="article__list slide-up-hidden" >
        
        
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/troubleshooting/ssh-too-long-error/">Why does it take 4-5 seconds to SSH to my instance?</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/troubleshooting/ping-instance-error/">Why can't I SSH to an instance, or ping it?</a>
          </li>
          
        
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/troubleshooting/nova-microversions-error/">Error: 'Server doesn't support microversions' When Running Nova Commands</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/troubleshooting/libvirt_error/">Instance in error status: libvirt error</a>
          </li>
          
        
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/troubleshooting/Bad_Availability_Zone/">Cloud Foundry: Invalid Availability Zone Error</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/troubleshooting/How_many_connections_can_HAProxy_handle/">How Many Simultaneous Connections can HAProxy Handle?</a>
          </li>
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/troubleshooting/failed_to_create_router/">Attempt to Create a Router is Failing</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/troubleshooting/failure_prepping_block_device/">Error: Failure prepping block device</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/troubleshooting/CLI-authentication-error/">When using any of the OpenStack CLIs on Windows, I get authentication failure errors</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/troubleshooting/Cannot_See_New_vCPUs/">Why Can't I See My New vCPUs Listed in Horizon?</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/troubleshooting/floating-ips-error/">Why are all the floating IPs that were assigned to me not available?</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/troubleshooting/no-valid-host-error/">Error: No valid host was found</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/troubleshooting/horizon-delete-error/">Why can't I delete my project/tenant from the Horizon dashboard?</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/troubleshooting/delete_security_group/">Why Can’t I Delete A Security Group?</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/troubleshooting/Troubleshooting_FAQ/">Troubleshooting FAQ</a>
          </li>
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/troubleshooting/Unable_to_ping_tenant_network/">Why Can't I Ping Across My Tenant Networks?</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/troubleshooting/Why_No_vIP_Failover_With_L2pop/">Why can't I use L2pop when I want my vIP instances to failover?</a>
              </li>
            
          
        
        <li><a href="" class="page-link view">View More ( 11 )</a></li>
      </ul>
    </li>
    <li>
      <h3 class="title">
        <a  class="page-link"  href="/bluebox/help-documentation/pt_BR/openstack">Open Stack (15)</a>
        <a href=""  class="expand rotate" ><img src="/bluebox/help-documentation/img/pt_BR/arrow.svg" /></a>
      </h3>
      <ul  class="article__list slide-up-hidden" >
        <h5 class="sub__head">User Docs</h5>
        
        
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/openstack/userdocs/import-vhd-image-lvm/">Importing a VHD image that uses linux volume management for its root directory</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/openstack/userdocs/launch-instance-from-volume/">How to Launch an Instance from a Volume</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/openstack/userdocs/Mitaka_CLI_notes/">OpenStack Mitaka CLI Notes</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/openstack/userdocs/openstack-storage-concepts/">OpenStack Storage Concepts</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/openstack/userdocs/OpenStack_network_concepts/">OpenStack Network Concepts</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/openstack/userdocs/Creating-an-Instance-with-a-Specific-Fixed-IP/">Creating an Instance with a Specific Fixed IP</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/openstack/userdocs/Why-Choose-OpenStack/">Why Choose OpenStack?</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/openstack/userdocs/Ursula_and_OpenStack/">Ursula and OpenStack</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/openstack/userdocs/quotas/">Quotas</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/openstack/userdocs/Creating_Instances_With_Static_IP/">How to Create An Instance With Static IP</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/openstack/userdocs/How_to_Isolate_Tenants/">How to Isolate Tenants (Projects)</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/openstack/userdocs/external-reference-material/">External reference materials</a>
          </li>
          
        
        <li><a href="" class="page-link view">View More ( 3 )</a></li>
      </ul>

      <ul  class="article__list slide-up-hidden" >
        <h5 class="sub__head">API</h5>
        
        
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/openstack/api/openstack-api-getting-started/">Getting Started with the OpenStack API</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/openstack/api/floating-ip-address/">Creating a floating IP address using the OpenStack API</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/openstack/api/OpenStack_Client_Versions/">Requirements for OpenStack client versions</a>
              </li>
            
          
        
        <li><a href="" class="page-link view">View More ( 1 )</a></li>
      </ul>
    </li>




    <li>
      <h3 class="title">
        <a  class="page-link"  href="/bluebox/help-documentation/pt_BR/horizon">Horizon [GUI] (10)</a>
        <a href=""  class="expand rotate" ><img src="/bluebox/help-documentation/img/pt_BR/arrow.svg" /></a>
      </h3>
      <ul  class="article__list slide-up-hidden" >
        
        
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/horizon/creating-additional-networks-with-horizon/">Creating Additional Networks in OpenStack Using the Horizon Panel</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/horizon/using-horizon/">Using Horizon</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/horizon/allocate-floating-ip/">Allocating and Attaching a Public (Floating) IP to an Instance</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/horizon/create-volume-from-horizon/">Creating a volume from the Horizon dashboard</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/horizon/Making_Snapshots_in_Horizon/">Using Horizon for Snapshots</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/horizon/set-reverse-dns/">How do I set a reverse DNS (PTR) record for an IBM Bluemix Private Cloud instance?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/horizon/launch-instance-from-horizon/">Launching an instance from the Horizon dashboard</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/horizon/launch-instance-from-horizon_newton/">Launching an instance from the Horizon dashboard (OpenStack Newton release)</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/horizon/horizon-for-administrators/">Horizon for Administrators</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/horizon/Horizon_troubleshooting_FAQ/">Horizon Troubleshooting FAQ</a>
          </li>
          
        
      </ul>
    </li>

    <li>
      <h3 class="title">
        <a  class="page-link"  href="/bluebox/help-documentation/pt_BR/nova">Nova [Compute] (13)</a>
        <a href=""  class="expand rotate" ><img src="/bluebox/help-documentation/img/pt_BR/arrow.svg" /></a>
      </h3>
      <ul  class="article__list slide-up-hidden" >
        
        
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/nova/CLI-create-public-instance/">How to Create an Instance and Make it Available Publicly Using the Command Line</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/nova/windows-user-and-password/">How do I set an initial username and password on a Windows instance in OpenStack?</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/nova/Nova_boot_speed/">What happens behind the scenes when I boot a virtual machine, and how can I make it boot faster?</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/nova/Restrict_Floating_IP/">How Can I Restrict Floating IPs?</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/nova/config_drive_for_instances/">Can I create an instance and add files to it using config drive?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/nova/create-vm-with-volumes/">How can I create an instance with the Nova command line client?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/nova/migrate-instance/">Migrating an instance to a new cloud</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/nova/deploy-to-specific-hypervisor/">How to deploy an instance to a specific hypervisor node</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/nova/nova_live_migration/">Instance Live Migration</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/nova/maximum-flavor-spec/">What is the maximum spec I can set for a flavor?</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/nova/define-flavor-vcpu/">How can I define flavor vCPU topology?</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/nova/Metadata_service_FAQ/">Metadata Service in OpenStack Neutron and Nova</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/nova/hypervisor-statistics/">How can I get hypervisor statistics?</a>
          </li>
          
        
      </ul>
    </li>

    <li>
      <h3 class="title">
        <a  class="page-link"  href="/bluebox/help-documentation/pt_BR/neutron">Neutron [Networking] (22)</a>
        <a href=""  class="expand rotate" ><img src="/bluebox/help-documentation/img/pt_BR/arrow.svg" /></a>
      </h3>
      <ul  class="article__list slide-up-hidden" >
        
        
        
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/neutron/network_ip_availability/">How Can I Check My Network IP Availability?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/neutron/Multi-tier_Router_Configuration/">Multi-tier Router Configuration Within Your IBM Bluemix Private Cloud</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/neutron/routing_internal_traffic_between_projects/">Routing Internal Traffic Between Projects</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/neutron/configure-dns.for-instances/">Configuring DNS for Instances</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/neutron/Load_Balancing_Methods/">Load Balancing Methods</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/neutron/set-up-dns-records/">How do I set up DNS records pointing to OpenStack instances?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/neutron/time-ip-associated-with-instance/">How can I find the time a floating IP was associated or disassociated from an instance?</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/neutron/isolatetwoprojectnetworksconnectedtoonesharedrouter/">How can you isolate project networks connected to a shared router?</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/neutron/creating-virtual-networks/">Creating virtual networks on IBM Bluemix Private Cloud</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/neutron/add-ip-to-instance/">Add a Specific Fixed Private IP to an Instance</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/neutron/configure-multi-nics/">Configuring multiple network interfaces for your own cloud images</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/neutron/configure-ha-ip/">How to configure a highly-available IP</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/neutron/BYOFIP_support/">Using BYOFIP Connectivity Between IBM Bluemix Private Cloud and a Customer Site</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/neutron/when_create_port_fails/">When creating port failed, how could I do ?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/neutron/vpn-vlan-directlink/">VPN, VLAN, and Direct Link</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/neutron/How_Can_I_See_My_IPs/">How Can I See My IPs?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/neutron/How_to_update_DNS/">How Can I Update DNS?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/neutron/Intro_to_LBaaS/">Introduction to Load Balancer as a Service (LBaaS)</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/neutron/Security_groups_CLI/">Using the CLI to Set Up Security Groups</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/neutron/Network_Use_Cases_White_Paper/">IBM Blue Box Network Use Cases</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/neutron/Where_Are_These_IPs/">Where Are the First Two IPs?</a>
              </li>
            
          
        
      </ul>
    </li>

    <li>
      <h3 class="title">
        <a  class="page-link"  href="/bluebox/help-documentation/pt_BR/glance">Glance [Images] (6)</a>
        <a href=""  class="expand rotate" ><img src="/bluebox/help-documentation/img/pt_BR/arrow.svg" /></a>
      </h3>
      <ul  class="article__list slide-up-hidden" >
        
        
        
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/glance/disk-capacity-constraints/">Disk Capacity Constraints</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/glance/FAQ_Working_with_Windows_Images/">Working with Windows Images FAQ</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/glance/compatible-glance-images/">Is there a list of official OpenStack-compatible images that I can download for use with Glance? (CentOS, Ubuntu, etc.)</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/glance/Image_Properties_on_Power/">Optimal Settings for Glance Images on Power Compute</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/glance/imagesnapshot/">Difference Between Image and Snapshot</a>
              </li>
            
          
        
      </ul>
    </li>

    <li>
      <h3 class="title">
        <a  class="page-link"  href="/bluebox/help-documentation/pt_BR/cinder">Cinder [Block Storage] (13)</a>
        <a href=""  class="expand rotate" ><img src="/bluebox/help-documentation/img/pt_BR/arrow.svg" /></a>
      </h3>
      <ul  class="article__list slide-up-hidden" >
        
        
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/cinder/cinder-volume-stuck/">Cinder Volume Stuck</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/cinder/read-only-cinder-error/">What causes read-only Cinder volumes and how can I fix them?</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/cinder/alternative_method_for_volume_encryption/">Alternative Method For Block Storage Volume Encryption (using an Ubuntu Guest VM)</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/cinder/Bug_Creating_Encrypted_Volumes/">Creating Encrypted Volumes with Cinder is Not Supported</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/cinder/create-volume-from-snapshot/">Is creating a volume from an instance snapshot supported?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/cinder/resize_cinder_volume/">How Can I Resize a Cinder Volume?</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/cinder/Managing_block_storage/">Managing Block Storage</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/cinder/cli-create-volume/">Creating a volume with the command line</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/cinder/supported_volume_types/">Which Cinder Volume Types are supported in Cloud Instance?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/cinder/Ephemeral_to_Cinder/">How to Move from Ephemeral Disk to Cinder Storage</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/cinder/volume_clone/">Can I enable volume full clone more than copy-on-write clone?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/cinder/Force_snapshot_on_attached_volume/">How to Force a Snapshot on an Attached Volume</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/cinder/cinder-failed-connection-error/">What do I do if the Cinder client returns 'ERROR: Unable to establish connection' message and fails to connect?</a>
              </li>
            
          
        
      </ul>
    </li>

    <li>
      <h3 class="title">
        <a  class="page-link"  href="/bluebox/help-documentation/pt_BR/keystone">Keystone [Identity] (8)</a>
        <a href=""  class="expand rotate" ><img src="/bluebox/help-documentation/img/pt_BR/arrow.svg" /></a>
      </h3>
      <ul  class="article__list slide-up-hidden" >
        
        
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/keystone/k2k-federation/">Keystone to Keystone (K2K) Federation on IBM Bluemix Private Cloud</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/keystone/Managing_Users_and_Projects/">Managing Users and Projects</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/keystone/RBAC_Definitions/">Role-Based Access Control</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/keystone/saml-federation/">Keystone SAML Federation on IBM Bluemix Private Cloud</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/keystone/oidc-federation/">OpenID Connect Federation on IBM Bluemix Private Cloud</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/keystone/Getting_Started_with_K2K_Identity/">Getting Started with Keystone Federated Identity</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/keystone/custom-domains-keystone/">Custom Domains within Keystone V3</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/keystone/tenants-security-groups-keystone/">Projects and Security Groups</a>
              </li>
            
          
        
      </ul>
    </li>

    <li>
      <h3 class="title">
        <a  class="page-link"  href="/bluebox/help-documentation/pt_BR/heat">Heat [Orchestration] (7)</a>
        <a href=""  class="expand rotate" ><img src="/bluebox/help-documentation/img/pt_BR/arrow.svg" /></a>
      </h3>
      <ul  class="article__list slide-up-hidden" >
        
        
        
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/heat/Getting_Started_With_Heat/">Getting Started With Heat Templates</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/bluebox/help-documentation/pt_BR/heat/Deploying_apps_with_UCD/">Deploying Applications with IBM UrbanCode Deploy and IBM Bluemix Private Cloud</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/heat/autoscaling-with-heat/">Using Heat for autoscaling</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/heat/using_heat_for_load_balancer/">Using Heat for provisioning servers with a load balancer</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/heat/using-ucd-ucdp/">Using IBM Urban Code Deploy with IBM Bluemix Private Cloud</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/heat/using_heat_for_deployment/">Using Heat With a Self-signed Certificate</a>
              </li>
            
          
        
      </ul>
    </li>


    <li>
      <h3 class="title">
        <a  class="page-link"  href="/bluebox/help-documentation/pt_BR/ceilometer">Ceilometer [Telemetry] (1)</a>
        <a href=""  class="expand rotate" ><img src="/bluebox/help-documentation/img/pt_BR/arrow.svg" /></a>
      </h3>
      <ul  class="article__list slide-up-hidden" >
        
        
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/bluebox/help-documentation/pt_BR/ceilometer/compatible-glance-images/">Is creating a volume from an instance snapshot supported?</a>
              </li>
            
          
        
      </ul>
    </li>

  </ul>
</div>


<article>

  <div class="page-container">

    <div class="main-content">
      <header class="post-header">

        <h1 class="post-title">
        

        

        Setting up OpenVPN server on your instance

        
        </h1>




        
        <div class="post-data">
          <img src='/bluebox/help-documentation/img/pt_BR/avatar.png' />
          <ul class="author--info">
            <li>
              <span class="author">by Jason Kennedy </span>
              <span class="dot">&#9679;</span>
              <span class="date"> January 7th, 2016</span>
            </li>
            <li>
              <span class="job-title"></span>
            </li>
            <li class="tags">
              
                <h4>Tags:</h4>
                  <ul class="tag--list">
                  
                    <li class="tag"><p>getting started</p></li>
                  
                    <li class="tag"><p>setting up openVPN</p></li>
                  
                  </ul>
              
            </li>
          </ul>
        </div>
        
      </header>

      <div class="post-content">
        <p>Quando precisar conectar às instâncias internas do Bluemix Private Cloud, mas você não tiver os endereços IP flutuantes disponíveis ou preferir não colocar essas máquinas virtuais na Internet, um recurso é estabelecer um host bastião com o OpenVPN em execução nele. Dessa maneira, é possível conectar e passar do host para sua rede interna. Neste artigo, você aprenderá como instalar e configurar o cliente e o servidor OpenVPN para a conexão.
Suponha que você já esteja executando uma máquina virtual que tenha um IP flutuante alocado para ela. Nós não vamos discutir a configuração de ufw ou entrar em nenhum reforço de Linux, estas instruções são estritamente sobre como deixar o OpenVPN funcionando em uma instância hospedada no OpenStack. Para este exemplo, estamos usando o Ubuntu 14.04.</p>

<p>Conclua estas etapas para a configuração do lado do servidor.</p>

<h2 id="etapa-1---configuração-do-openvpn">Etapa 1 - Configuração do OpenVPN</h2>

<p>Antes de instalar qualquer pacote, vamos atualizar as listas de repositórios do Ubuntu.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">apt-get update</code></pre></figure>

<p>Em seguida, podemos instalar o OpenVPN e Easy-RSA.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">apt-get install openvpn easy-rsa</code></pre></figure>

<p>O arquivo de configuração do servidor VPN de exemplo precisa ser extraído para <code class="highlighter-rouge">/etc/openvpn</code> para que possamos incorporá-lo em nossa configuração. Esta extração pode ser feita com um comando:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">gunzip -c /usr/share/doc/openvpn/examples/sample-config-files/server.conf.gz &gt; /etc/openvpn/server.conf</code></pre></figure>

<p>Depois de extraído, abra <code class="highlighter-rouge">server.conf</code> em um editor de texto. Este tutorial usará o <strong>Vim</strong>, mas você pode usar o editor de sua preferência.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">vim /etc/openvpn/server.conf</code></pre></figure>

<p>Há várias mudanças a fazer neste arquivo. Você verá uma seção semelhante ao seguinte:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># Diffie hellman parameters.
</span>
<span class="c"># Generate your own with:
</span>
<span class="c">#   openssl dhparam -out dh1024.pem 1024
</span>
<span class="c"># Substitute 2048 for 1024 if you are using
</span>
<span class="c"># 2048 bit keys.
</span>
dh dh1024.pem</code></pre></figure>

<p>Edite <code class="highlighter-rouge">dh1024.pem</code> para indicar <code class="highlighter-rouge">dh2048.pem</code></p>

<p>Essa mudança dobrará o comprimento da chave RSA usado ao gerar chaves do servidor e do cliente.</p>

<p>Ainda no arquivo <code class="highlighter-rouge">server.conf</code>, veja esta seção:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># If enabled, this directive will configure
</span>
<span class="c"># all clients to redirect their default
</span>
<span class="c"># network gateway through the VPN, causing
</span>
<span class="c"># all IP traffic such as web browsing and
</span>
<span class="c"># and DNS lookups to go through the VPN
</span>
<span class="c"># (The OpenVPN server machine may need to NAT
</span>
<span class="c"># or bridge the TUN/TAP interface to the internet
</span>
<span class="c"># in order for this to work properly).
</span>
;push <span class="s2">"redirect-gateway def1 bypass-dhcp"</span></code></pre></figure>

<p>Remova os comentários <code class="highlighter-rouge">push "redirect-gateway def1 bypass-dhcp"</code> para que o servidor VPN passe pelo tráfego da web dos clientes para seu destino. A linha deve ser semelhante ao seguinte quando pronta:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">push <span class="s2">"redirect-gateway def1 bypass-dhcp"</span></code></pre></figure>

<p>A próxima edição a fazer é nesta área do arquivo:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># Certain Windows-specific network settings
</span>
<span class="c"># can be pushed to clients, such as DNS
</span>
<span class="c"># or WINS server addresses.  CAVEAT:
</span>
<span class="c"># http://openvpn.net/faq.html#dhcpcaveats
</span>
<span class="c"># The addresses below refer to the public
</span>
<span class="c"># DNS servers provided by opendns.com.
</span>
;push <span class="s2">"dhcp-option DNS 208.67.222.222"</span>
;push <span class="s2">"dhcp-option DNS 208.67.220.220"</span></code></pre></figure>

<p>Remova os comentários <code class="highlighter-rouge">push "dhcp-option DNS 208.67.222.222"</code> e <code class="highlighter-rouge">push "dhcp-option DNS 208.67.220.220"</code>. As entradas devem ser semelhantes ao seguinte quando prontas:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">push <span class="s2">"dhcp-option DNS 208.67.222.222"</span>
push <span class="s2">"dhcp-option DNS 208.67.220.220"</span></code></pre></figure>

<p>Essa entrada diz ao servidor para enviar por push <strong>OpenDNS</strong> para os clientes conectados para resolução DNS onde possível. Usar push pode ajudar a evitar que as solicitações DNS saiam da conexão VPN. No entanto, é importante especificar os resolvedores DNS desejados nos dispositivos do cliente também. Embora <strong>OpenDNS</strong> seja o padrão usado por <strong>OpenVPN</strong>, é possível usar os serviços DNS que você preferir.</p>

<p>A última área a mudar no arquivo <code class="highlighter-rouge">server.conf</code> é aqui:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># You can uncomment this out on
</span>
<span class="c"># non-Windows systems.
</span>
;user nobody
;group nogroup</code></pre></figure>

<p>Remova os comentários <code class="highlighter-rouge">user nobody</code> e <code class="highlighter-rouge">group nogroup</code>. Quando finalizada, a entrada deve ser assim:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">user nobody
group nogroup</code></pre></figure>

<p>Por padrão, <strong>OpenVPN</strong> é executado como o usuário raiz e, então, tem total acesso raiz ao sistema. Em vez disso, restrinja <strong>OpenVPN</strong> a <code class="highlighter-rouge">user nobody</code> e <code class="highlighter-rouge">group nogroup</code>, que é um usuário sem privilégios sem nenhum recurso de login padrão, frequentemente reservado para executar aplicativos não confiáveis como servidores voltados para a web.</p>

<p>Agora, salve suas mudanças e saia de <strong>Vim</strong>.</p>

<h3 id="encaminhamento-de-pacote">Encaminhamento de pacote</h3>

<p>Precisamos de uma configuração <code class="highlighter-rouge">sysctl</code> que diga ao kernel do servidor para encaminhar o tráfego dos dispositivos do cliente para a Internet. Caso contrário, o tráfego irá parar no servidor. Ative o encaminhamento de pacote durante o tempo de execução inserindo este comando:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">echo </span>1 &gt; /proc/sys/net/ipv4/ip_forward</code></pre></figure>

<p>Agora, precisamos tornar esse encaminhamento permanente, para que o servidor ainda encaminhe o tráfego após a reinicialização.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">vim /etc/sysctl.conf</code></pre></figure>

<p>Perto da parte superior do arquivo <code class="highlighter-rouge">sysctl</code>, você verá:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># Uncomment the next line to enable packet forwarding for IPv4
</span>
<span class="c">#net.ipv4.ip_forward=1</span></code></pre></figure>

<p>Remova o comentário net.ipv4.ip_forward. A linha deve ser semelhante ao seguinte quando pronta:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># Uncomment the next line to enable packet forwarding for IPv4
</span>
net.ipv4.ip_forward<span class="o">=</span>1</code></pre></figure>

<p>Salve suas mudanças e saia de <strong>Vim</strong>.</p>

<h3 id="firewall-descomplicado-ufw">Firewall descomplicado (ufw)</h3>

<p><code class="highlighter-rouge">ufw</code> é um front-end para iptables. Configurar <code class="highlighter-rouge">ufw</code> não é difícil. Ele é incluído por padrão no Ubuntu 14.04, então, nós só precisamos fazer algumas regras e edições de configuração e, em seguida, ligar o firewall. Como referência para mais usos para <code class="highlighter-rouge">ufw</code>, consulte <strong>Como configurar um firewall com UFW em um servidor em nuvem Debian e Ubuntu</strong>.</p>

<p>Primeiro, configure <code class="highlighter-rouge">ufw</code> para permitir SSH. No prompt de comandos, insira:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">ufw allow ssh</code></pre></figure>

<p>Este tutorial usará <strong>OpenVPN</strong> sobre UDP, então, ufw também deve permitir o tráfego UDP através da porta 1194.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">ufw allow 1194/udp</code></pre></figure>

<p>A política de encaminhamento de <code class="highlighter-rouge">ufw</code> também precisa ser configurada. Faremos isso no arquivo de configuração primário do ufw.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">vim /etc/default/ufw</code></pre></figure>

<p>Procure <code class="highlighter-rouge">DEFAULT_FORWARD_POLICY="DROP"</code>. Essa entrada deve ser mudada de <code class="highlighter-rouge">DROP</code> para <code class="highlighter-rouge">ACCEPT.</code> A entrada deve ser semelhante ao seguinte quando pronta:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">DEFAULT_FORWARD_POLICY</span><span class="o">=</span><span class="s2">"ACCEPT"</span></code></pre></figure>

<p>A seguir, vamos incluir regras <code class="highlighter-rouge">ufw</code> adicionais para conversão de endereço de rede e mascaramento IP de clientes conectados.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">vim /etc/ufw/before.rules</code></pre></figure>

<p>Faça com que a parte superior do seu arquivo <code class="highlighter-rouge">before.rules</code> seja semelhante ao exemplo a seguir. A área em vermelho para <code class="highlighter-rouge">OPENVPN RULES</code> deve ser incluída:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c">#
</span>
<span class="c"># rules.before
</span>
<span class="c">#
</span>
<span class="c"># Rules that should be run before the ufw command line added rules. Custom
</span>
<span class="c"># rules should be added to one of these chains:
</span>
<span class="c">#   ufw-before-input
</span>
<span class="c">#   ufw-before-output
</span>
<span class="c">#   ufw-before-forward
</span>
<span class="c">#
</span>

<span class="c"># START OPENVPN RULES
</span>
<span class="c"># NAT table rules
</span>
<span class="k">*</span>nat
:POSTROUTING ACCEPT <span class="o">[</span>0:0]
<span class="c"># Allow traffic from OpenVPN client to eth0
</span>
-A POSTROUTING -s 10.8.0.0/8 -o eth0 -j MASQUERADE
COMMIT
<span class="c"># END OPENVPN RULES
</span>

<span class="c"># Don't delete these required lines, otherwise there will be errors
</span>
<span class="k">*</span>filter</code></pre></figure>

<p>Com as mudanças feitas em <code class="highlighter-rouge">ufw</code>, podemos ativá-lo agora. Insira no prompt de comandos:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">ufw <span class="nb">enable</span></code></pre></figure>

<p>Ativar <code class="highlighter-rouge">ufw</code> retornará o seguinte aviso:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">Command may disrupt existing ssh connections. Proceed with operation <span class="o">(</span>y|n<span class="o">)</span>?</code></pre></figure>

<p>Responda <code class="highlighter-rouge">y</code>. O resultado será essa saída:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">Firewall is active and enabled on system startup</code></pre></figure>

<p>Para verificar as regras de firewall primário do ufw:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">ufw status</code></pre></figure>

<p>O comando de status deve retornar esses resultados:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">Status: active

To                         Action      From
--                         ------      ----
22                         ALLOW       Anywhere
1194/udp                   ALLOW       Anywhere
22 <span class="o">(</span>v6<span class="o">)</span>                    ALLOW       Anywhere <span class="o">(</span>v6<span class="o">)</span>
1194/udp <span class="o">(</span>v6<span class="o">)</span>              ALLOW       Anywhere <span class="o">(</span>v6<span class="o">)</span></code></pre></figure>

<h2 id="etapa-2---criando-uma-autoridade-de-certificação-e-certificado-do-lado-do-servidor--chave">Etapa 2 - Criando uma autoridade de certificação e certificado do lado do servidor &amp; chave</h2>

<p>O <strong>OpenVPN</strong> usa certificados para criptografar o tráfego.</p>

<h3 id="configurar-e-construir-a-autoridade-de-certificação">Configurar e construir a autoridade de certificação</h3>

<p>Agora é o momento de configurar nossa própria Autoridade de Certificação (CA) e gerar um certificado e chave para o servidor <strong>OpenVPN</strong>. O <strong>OpenVPN</strong> suporta a autenticação bidirecional com base em certificados, o que significa que o cliente deve autenticar o certificado do servidor e o servidor deve autenticar o certificado do cliente antes que a confiança mútua seja estabelecida. Vamos usar scripts do Easy RSA que copiamos anteriormente para fazer isso.</p>

<p>Primeiro, copie os scripts de geração do Easy-RSA.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">cp -r /usr/share/easy-rsa/ /etc/openvpn</code></pre></figure>

<p>Em seguida, faça o diretório de armazenamento de chaves.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">mkdir /etc/openvpn/easy-rsa/keys</code></pre></figure>

<p>O Easy-RSA tem um arquivo de variáveis que podemos editar para criar certificados exclusivos para nossa pessoa, negócio ou qualquer entidade que escolhermos. Essa informação é copiada para os certificados e chaves, e ajudará a identificar as chaves mais tarde.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">vim /etc/openvpn/easy-rsa/vars</code></pre></figure>

<p>As variáveis abaixo devem ser mudadas de acordo com sua preferência.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">export </span><span class="nv">KEY_COUNTRY</span><span class="o">=</span><span class="s2">"US"</span>
<span class="nb">export </span><span class="nv">KEY_PROVINCE</span><span class="o">=</span><span class="s2">"TX"</span>
<span class="nb">export </span><span class="nv">KEY_CITY</span><span class="o">=</span><span class="s2">"Dallas"</span>
<span class="nb">export </span><span class="nv">KEY_ORG</span><span class="o">=</span><span class="s2">"My Company Name"</span>
<span class="nb">export </span><span class="nv">KEY_EMAIL</span><span class="o">=</span><span class="s2">"sammy@example.com"</span>
<span class="nb">export </span><span class="nv">KEY_OU</span><span class="o">=</span><span class="s2">"MYOrganizationalUnit"</span></code></pre></figure>

<p>No mesmo arquivo vars, edite também esta linha mostrada abaixo. Para simplificar, vamos usar o servidor como o nome da chave. Se desejar usar um nome diferente, pode ser necessário também atualizar os arquivos de configuração do <strong>OpenVPN</strong> que fazem referência a <code class="highlighter-rouge">server.key</code> e <code class="highlighter-rouge">server.crt</code>.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">export </span><span class="nv">KEY_NAME</span><span class="o">=</span><span class="s2">"server"</span></code></pre></figure>

<p>Nós precisamos gerar os parâmetros Diffie-Hellman; isso pode demorar alguns minutos.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">openssl dhparam -out /etc/openvpn/dh2048.pem 2048</code></pre></figure>

<p>Agora, vamos mudar os diretórios para trabalharmos diretamente fora de para onde movemos os scripts do Easy-RSA anteriormente na Etapa 2.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">cd</span> /etc/openvpn/easy-rsa</code></pre></figure>

<p>Inicialize a PKI (Infraestrutura de Chave Pública). Preste atenção ao ponto (.) e ao espaço na frente de <code class="highlighter-rouge">./varscommand</code>. Isso significa o diretório atualmente em funcionamento (origem).</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">. ./vars</code></pre></figure>

<p>A saída do comando acima é mostrada abaixo. Como nós ainda não geramos nada no diretório de chaves, o aviso não é nada preocupante.</p>

<p>NOTA: se você executar <code class="highlighter-rouge">./clean-all</code>, eu vou fazer um <code class="highlighter-rouge">rm -rf</code> em <code class="highlighter-rouge">/etc/openvpn/easy-rsa/keys</code>
Agora, nós vamos limpar o diretório ativo de quaisquer chaves de exemplo ou chaves antigas possíveis para dar lugar às nossas novas.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">./clean-all</code></pre></figure>

<p>Esse comando final constrói a autoridade de certificação (CA) chamando um comando <strong>OpenSSL</strong> interativo. A saída solicitará que você confirme as variáveis de Nome Distinto que foram inseridas anteriormente no arquivo de variáveis do Easy-RSA (nome do país, organização, etc.).</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">./build-ca</code></pre></figure>

<p>Pressione ENTER para passar por cada aviso. Se algo tiver que ser mudado, isso poderá ser feito de dentro do aviso.</p>

<h3 id="gerar-um-certificado-e-chave-para-o-servidor">Gerar um certificado e chave para o servidor</h3>

<p>Ainda trabalhando do <code class="highlighter-rouge">/etc/openvpn/easy-rsa</code>, insira o comando para construir a chave do servidor. Onde você vir o servidor marcado em vermelho é a variável <code class="highlighter-rouge">KEY_NAME</code> de exportação que nós configuramos no arquivo vars do Easy-RSA antes na Etapa 2.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">./build-key-server server</code></pre></figure>

<p>Uma saída semelhante é gerada como quando nós executamos <code class="highlighter-rouge">./build-ca</code> e você pode novamente pressionar ENTER para confirmar cada linha do Nome Distinto. No entanto, dessa vez há dois avisos adicionais:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">Please enter the following <span class="s1">'extra'</span> attributes
to be sent with your certificate request
A challenge password <span class="o">[]</span>:

An optional company name <span class="o">[]</span>:</code></pre></figure>

<p>Ambos devem ser deixados em branco, portanto, só pressione ENTER para passar por cada um.</p>

<p>Duas consultas adicionais no final exigem uma resposta positiva (<code class="highlighter-rouge">y</code>):</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">Sign the certificate? <span class="o">[</span>y/n]
1 out of 1 certificate requests certified, commit? <span class="o">[</span>y/n]</code></pre></figure>

<p>O último aviso acima deve ser concluído com:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">Write out database with 1 new entries
Data Base Updated</code></pre></figure>

<h3 id="mover-as-chaves-e-os-certificados-do-servidor">Mover as chaves e os certificados do servidor</h3>

<p>O OpenVPN espera ver a CA do servidor, o certificado e a chave em <code class="highlighter-rouge">/etc/openvpn</code>. Vamos copiá-los no local adequado.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">cp /etc/openvpn/easy-rsa/keys/<span class="o">{</span>server.crt,server.key,ca.crt<span class="o">}</span> /etc/openvpn</code></pre></figure>

<p>É possível verificar se a operação de cópia foi bem-sucedida com este comando:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">ls /etc/openvpn</code></pre></figure>

<p>Você deve ver o certificado e os arquivos-chave para o servidor.</p>

<p>Nesse ponto, o servidor <strong>OpenVPN</strong> está pronto. Inicie-o e verifique o status.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">service openvpn start
service openvpn status</code></pre></figure>

<p>O comando de status deve retornar esse resultado:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">VPN <span class="s1">'server'</span> is running</code></pre></figure>

<p>Parabéns! Seu servidor OpenVPN está operacional.</p>

<p>Se a mensagem de status disser que a VPN não está em execução, dê uma olhada no <code class="highlighter-rouge">arquivo /var/log/syslog</code> para ver se há erros como:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">Options error: --key fails with <span class="s1">'server.key'</span>: No such file or directory</code></pre></figure>

<p>Esse erro indica que <code class="highlighter-rouge">server.key</code> não foi copiado para <code class="highlighter-rouge">/etc/openvpn</code> corretamente. Copie outra vez o arquivo e tente novamente.</p>

<h2 id="etapa-3---gerar-certificados-e-chaves-para-clientes">Etapa 3 - Gerar certificados e chaves para clientes</h2>

<p>Até agora, nós instalamos e configuramos o servidor <strong>OpenVPN</strong>, criamos uma Autoridade de Certificação e criamos o próprio certificado e a chave do servidor. Nesta etapa, usamos a CA do servidor para gerar certificados e chaves para cada dispositivo do cliente que vai se conectar à VPN. Mais tarde, esses arquivos serão instalados nos dispositivos do cliente, como um laptop ou smartphone.</p>

<h3 id="construção-da-chave-e-do-certificado">Construção da chave e do certificado</h3>

<p>É o ideal para cada cliente que está se conectando à VPN ter sua própria chave e certificado exclusivos. Essa configuração é preferível a gerar uma chave e certificado gerais para usar entre todos os dispositivos do cliente.</p>

<p><strong>Nota:</strong> Por padrão, o <strong>OpenVPN</strong> não permite conexões simultâneas ao servidor de clientes usando a mesma chave e certificado. (Veja <code class="highlighter-rouge">duplicate-cn</code> em <code class="highlighter-rouge">/etc/openvpn/server.conf</code>.)</p>

<p>Para criar credenciais de autenticação separadas para cada dispositivo que você pretende conectar à VPN, você deve concluir esta etapa para cada dispositivo, mas mudar o nome <code class="highlighter-rouge">client1</code> abaixo para algo diferente, como <code class="highlighter-rouge">client2</code> ou <code class="highlighter-rouge">iphone2</code>. Com credenciais separadas por dispositivo, eles podem depois ser desativados no servidor individualmente, se necessário. Os demais exemplos neste tutorial usarão <code class="highlighter-rouge">client1</code> como nome do nosso dispositivo do cliente de exemplo.</p>

<p>Como fizemos com a chave do servidor, agora construímos um para nosso exemplo <code class="highlighter-rouge">client1</code>. Você deve ainda estar trabalhando fora de <code class="highlighter-rouge">/etc/openvpn/easy-rsa</code>.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">./build-key client1</code></pre></figure>

<p>Novamente, será solicitado que você mude ou confirme as variáveis de Nome Distinto e esses dois avisos que devem ser deixados em branco. Pressione ENTER para aceitar os padrões.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">Please enter the following <span class="s1">'extra'</span> attributes
to be sent with your certificate request
A challenge password <span class="o">[]</span>:

An optional company name <span class="o">[]</span>:</code></pre></figure>

<p>Como anteriormente, essas duas confirmações no final do processo de construção requerem uma resposta (<code class="highlighter-rouge">y</code>):</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">Sign the certificate? <span class="o">[</span>y/n]
1 out of 1 certificate requests certified, commit? <span class="o">[</span>y/n]</code></pre></figure>

<p>Se a construção da chave foi bem-sucedida, a saída novamente será:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">Write out database with 1 new entries
Data Base Updated</code></pre></figure>

<p>O arquivo de configuração do cliente de exemplo deve ser copiado para o diretório-chave do Easy-RSA também. Nós o usaremos como um modelo que será transferido por download para dispositivos do cliente para edição. No processo de cópia, estamos mudando o nome do arquivo de exemplo de <code class="highlighter-rouge">client.conf</code> para <code class="highlighter-rouge">client.ovpn</code> porque a extensão do arquivo <code class="highlighter-rouge">.ovpn</code> é o que os clientes esperam usar.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">cp /usr/share/doc/openvpn/examples/sample-config-files/client.conf /etc/openvpn/easy-rsa/keys/client.ovpn</code></pre></figure>

<p>É possível repetir esta seção novamente para cada cliente, substituindo <code class="highlighter-rouge">client1</code> pelo nome do cliente apropriado completamente.</p>

<h3 id="transferindo-certificados-e-chaves-para-dispositivos-do-cliente">Transferindo certificados e chaves para dispositivos do cliente</h3>

<p>Rechamada das etapas acima que nós criamos as chaves e os certificados do cliente, e que eles são armazenados no servidor <strong>OpenVPN</strong> no diretório <code class="highlighter-rouge">/etc/openvpn/easy-rsa/keys</code>.</p>

<p>Para cada cliente, nós precisamos transferir o certificado do cliente, a chave e os arquivos de modelo do perfil para uma pasta em nosso computador local ou outro dispositivo do cliente.</p>

<p>Neste exemplo, nosso dispositivo <code class="highlighter-rouge">client1</code> requer seu certificado e chave, localizados no servidor em:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">/etc/openvpn/easy-rsa/keys/client1.crt
/etc/openvpn/easy-rsa/keys/client1.key</code></pre></figure>

<p>Os arquivos <code class="highlighter-rouge">ca.crt</code> e <code class="highlighter-rouge">client.ovpn</code> são os mesmos para todos os clientes. Faça também o download desses dois arquivos; observe que o arquivo <code class="highlighter-rouge">ca.crt</code> está em um diretório diferente dos outros.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">/etc/openvpn/easy-rsa/keys/client.ovpn
/etc/openvpn/ca.crt</code></pre></figure>

<p>Embora os aplicativos exatos usados para realizar essa transferência dependam de sua escolha e do sistema operacional do dispositivo, você quer que o aplicativo use SFTP (protocolo de transferência de arquivo SSH) ou SCP (Cópia Segura) no backend. Isso transportará os arquivos de autenticação VPN do cliente sobre uma conexão criptografada.</p>

<p>Aqui é mostrado um comando SCP de exemplo usando nosso exemplo <code class="highlighter-rouge">client1</code>. Ele coloca o arquivo <code class="highlighter-rouge">client1.key</code> no diretório de Downloads no computador local.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">scp root@your-server-ip:/etc/openvpn/easy-rsa/keys/client1.key Downloads/</code></pre></figure>

<p>Há várias ferramentas e tutoriais para transferir com segurança arquivos do servidor para um computador local:</p>

<p>WinSCP
Como usar o SFTP para transferir com segurança arquivos com um servidor remoto
Como usar o Filezilla para transferir e gerenciar arquivos com segurança em seu VPS</p>

<p>No final desta seção, certifique-se de ter esses quatro arquivos no dispositivo do cliente:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">client1.crt
client1.key
client.ovpn
ca.crt</code></pre></figure>

<h2 id="etapa-4---criando-um-perfil-openvpn-unificado-para-dispositivos-do-cliente">Etapa 4 - Criando um perfil OpenVPN unificado para dispositivos do cliente</h2>

<p>Há vários métodos para gerenciar os arquivos do cliente, mas o mais fácil usa um perfil unificado. Este é criado modificando o arquivo de modelo client.ovpn para incluir a Autoridade de Certificação do servidor e o certificado do cliente e sua chave. Depois de mesclado, apenas o único perfil client.ovpn precisa ser importado para o aplicativo OpenVPN do cliente.</p>

<p>Nós vamos criar um único perfil para nosso dispositivo client1 no computador local para o qual fizemos download de todos os arquivos do cliente. Esse computador local pode ele próprio ser um cliente desejado ou apenas uma área de trabalho temporária para mesclar os arquivos de autenticação. O arquivo de modelo client.ovpn original deve ser duplicado e renomeado. Como você vai fazer isso dependerá do sistema operacional do seu computador local.</p>

<p>Nota: o nome do client.ovpn duplicado não precisa estar relacionado ao dispositivo do cliente. O aplicativo OpenVPN do lado do cliente usará o nome do arquivo como um identificador para a conexão VPN em si. Em vez disso, você deve duplicar client.ovpn para o que você quiser que seja a tag de nome da VPN em seu sistema operacional. Por exemplo: work.ovpn será identificado como trabalho, school.ovpn como escola, etc.</p>

<p>Neste tutorial, vamos nomear a conexão VPN como Test1, então Test1.ovpn será o nome do arquivo referido a partir desse ponto. Depois de nomeado, devemos abrir Test1.ovpn em um editor de texto; você pode usar o editor que preferir.</p>

<p>A primeira área de atenção será para o endereço IP do seu Droplet. Perto da parte superior do arquivo, mude my-server-1 para refletir o IP de sua VPN.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># O nome do host/IP e a porta do servidor.
</span>
<span class="c"># É possível ter diversas entradas remotas
</span>
<span class="c"># para balanceamento de carga entre servidores.
</span>
remote my-server-1 1194</code></pre></figure>

<p>Em seguida, localize a área mostrada abaixo e remova o comentário <code class="highlighter-rouge">user nobody</code> e <code class="highlighter-rouge">group nogroup</code>, exatamente como fizemos em <code class="highlighter-rouge">server.conf</code> na Etapa 1. Nota: esta etapa não se aplica ao Windows, então, você pode ignorá-la. Quando finalizada, a entrada deve ser assim:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># Downgrade privileges after initialization (non-Windows only)
</span>
user nobody
group nogroup</code></pre></figure>

<p>A área apresentada abaixo precisa das três linhas mostradas para ser comentada, então, nós podemos incluir o certificado e a chave diretamente no arquivo <code class="highlighter-rouge">Test1.ovpn</code>. Ele deve ser semelhante ao seguinte quando pronto:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># SSL/TLS parms.
</span>
<span class="c"># . . .
</span>
<span class="c">#ca ca.crt
</span>
<span class="c">#cert client.crt
</span>
<span class="c">#key client.key</span></code></pre></figure>

<p>Para mesclar os arquivos individuais no perfil unificado, o conteúdo dos arquivos <code class="highlighter-rouge">ca.crt</code>, <code class="highlighter-rouge">client1.crt</code> e <code class="highlighter-rouge">client1.key</code> são colados diretamente no perfil <code class="highlighter-rouge">.ovpn</code> usando uma sintaxe básica semelhante a XML. O XML no final do arquivo deve ter o seguinte formato:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">&lt;ca&gt;
<span class="o">(</span>insert ca.crt here<span class="o">)</span>
&lt;/ca&gt;
&lt;cert&gt;
<span class="o">(</span>insert client1.crt here<span class="o">)</span>
&lt;/cert&gt;
&lt;key&gt;
<span class="o">(</span>insert client1.key here<span class="o">)</span>
&lt;/key&gt;</code></pre></figure>

<p>Quando concluído, o final do arquivo deve ser semelhante a esse exemplo abreviado:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">&lt;ca&gt;
-----BEGIN CERTIFICATE-----
. . .
-----END CERTIFICATE-----
&lt;/ca&gt;

&lt;cert&gt;
Certificate:
. . .
-----END CERTIFICATE-----
. . .
-----END CERTIFICATE-----
&lt;/cert&gt;

&lt;key&gt;
-----BEGIN PRIVATE KEY-----
. . .
-----END PRIVATE KEY-----
&lt;/key&gt;</code></pre></figure>

<p>O arquivo <code class="highlighter-rouge">client1.crt</code> contém algumas informações extras; é bom incluir o arquivo inteiro.</p>

<p>Salve as mudanças e saia. Nós, agora, temos um perfil do cliente <strong>OpenVPN</strong> unificado para configurar nosso <code class="highlighter-rouge">client1</code>.</p>

<p>A partir daqui, nós só precisamos alimentar o arquivo <code class="highlighter-rouge">.ovpn</code> no cliente VPN de sua escolha, seja Tunnelblick, Viscosity (ambos para OSX) ou o que você escolher.</p>

<p>Antes de testarmos isso, contudo, precisamos assegurar que o OpenStack esteja preparado para permitir a passagem desse tráfego. Vamos dar uma olhada em nossas instâncias:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">$ </span>nova list +--------------------------------------+----------------+--------+------------+-------------+--------------------------------------+
| ID | Name | Status | Task State | Power State | Networks | +--------------------------------------+----------------+--------+------------+-------------+--------------------------------------+
| 4f239959-be46-4fd3-963a-7c70db305d74 | jkbastion | ACTIVE | - | Running | <span class="nv">internal</span><span class="o">=</span>10.230.7.72, 173.247.105.20 | | 0d3c2002-ea02-4311-8142-b622f05407b4 | jkinternal-ssh | ACTIVE | - | Running | <span class="nv">internal</span><span class="o">=</span>10.230.7.68 | | 746e0ef8-48ee-4867-9c9d-e3d53a7e68bc | jkinternal-web | ACTIVE | - | Running | <span class="nv">internal</span><span class="o">=</span>10.230.7.69 | +--------------------------------------+----------------+--------+------------+-------------+--------------------------------------+</code></pre></figure>

<p>Formatação de lado devido ao espaço restrito, o que temos aqui são 3 instâncias; jkbastion, que tem um IP flutuante, e também jkinternal-ssh e jkinternal-web, que estão, obviamente, correlacionadas à web e ssh (a MV da web está executando nginx).</p>

<p>Além disso, vamos ver nossos grupos de segurança para assegurar que estamos permitindo o UDP 1194 para nosso host bastião:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">$ </span>nova secgroup-list
+--------------------------------------+-----------+------------------------+
| Id                                   | Name      | Description            |
+--------------------------------------+-----------+------------------------+
| 55608023-c88e-4446-b67c-b64e741df5cb | default   | default                |
| f33a4643-4440-4649-8ba6-aef09b00b7f7 | jkbastion | bastion security group |
| dcec8a37-9541-4286-a4ad-0290a44efbae |  jksec    | Jason Kennedy<span class="s1">'s shiz   |
+------------------------------ --------+-----------+------------------------+</span></code></pre></figure>

<p>Detalhes de jkbastion:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">$ </span>nova secgroup-list-rules f33a4643-4440-4649-8ba6-aef09b00b7f7
+-------------+-----------+---------+-----------+--------------+
| IP Protocol | From Port | To Port | IP Range  | Source Group |
+-------------+-----------+---------+-----------+--------------+
| tcp         | 22        | 22      | 0.0.0.0/0 |              |
| udp         | 1194      | 1194    | 0.0.0.0/0 |              |
+-------------+-----------+---------+-----------+--------------+</code></pre></figure>

<p>É isso! Com a VPN conectada, você deve ser capaz de acertar máquinas virtuais internas com os serviços necessários.</p>

      </div>
    </div>

  </div>
</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="footer__wrapper--light">

    <ul class="footer--nav">
      <li class="footer--nav__header">
        <a href="https://www.ibm.com/cloud-computing/bluemix/bluemix-private-cloud">Products</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/bluemix-private-cloud" class="nav--item__link">Bluemix Private Cloud</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/private-cloud-local" class="nav--item__link">Private Cloud Local</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/private-cloud-contact-us" class="nav--item__link">Sales</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/private-cloud-faq" class="nav--item__link">FAQs</a>
      </li>
    
    </ul>

    <ul class="footer--nav">
      <li class="footer--nav__header">
        <a href="https://www.ibm.com/cloud-computing/bluemix/bluemix-private-cloud">Our Story</a>
      </li>
 <li class="footer--nav__item">
        <a href="https://github.com/blueboxgroup?cm_mc_uid=04946053248414876234663&cm_mc_sid_50200000=1489010497" class="nav--item__link">On GitHub</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://blueboxstatus.com/" class="nav--item__link">System Status</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://support.bluebox.net/" class="nav--item__link">Support</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://support.bluebox.net/" class="nav--item__link">Box Panel</a>
      </li>
    </ul>

    <ul class="footer--nav">
      <li class="footer--nav__header">
        <a href="https://www.ibm.com/cloud-computing/bluemix/bluemix-private-cloud">Resources
        </a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/bluemix-private-cloud">Case Studies</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/bluemix-private-cloud" class="nav--item__link">Videos</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/bluemix-private-cloud" class="nav--item__link">News</a>
      </li>
    </ul>

    <ul class="footer--nav">
      <li class="footer--nav__header">
        <a href="hhttps://www.ibm.com/blogs/bluemix/">Recent Blog Posts</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/blogs/bluemix/2016/07/the-power-of-openstack/" class="nav--item__link">The Power of OpenStack</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/blogs/bluemix/2016/08/blue-box-storage-models-explained/" class="nav--item__link">IBM Bluemix Private Cloud Storage Models</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.blueboxcloud.com/insight/blog-article/github-ibm-com-running-on-blue-box" class="nav--item__link">IBM Github Runs on Bluemix Private Cloud</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/blogs/bluemix/2016/10/building-up-to-openstack/" class="nav--item__link">Building up to OpenStack</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/blogs/bluemix/2016/07/keystone-to-keystone-federated-identity-on-blue-box-cloud/" class="nav--item__link">Get Started with Keystone Federation</a>
      </li>
    </ul>
  </div>
  <div class="footer__wrapper--dark">
    <ul class="footer--list">
      <li class="list--item">
        <a href="https://www.facebook.com/BlueBoxGroup/" class="list--item__link">Facebook</a>
      </li>
      <li class="list--item">
        <a href="https://twitter.com/bluebox?ref_src=twsrc%5Egoogle%7Ctwcamp%5Eserp%7Ctwgr%5Eauthor" class="list--item__link">Twitter</a>
      </li>
      <li class="list--item">
        <a href="https://www.linkedin.com/company/blue-box-group" class="list--item__link">LinkedIn</a>
      </li>
      <li class="list--item">
        <a href="https://plus.google.com/+BlueBoxSeattle/posts" class="list--item__link">Google +</a>
      </li>
      <li class="list--item">
        <a href="https://github.com/blueboxgroup" class="list--item__link">GitHub</a>
      </li>
    </ul>

    <ul class="footer--list">
      <li class="list--item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/private-cloud-contact-us" class="list--item__link">Contact</a>
      </li>
      <li class="list--item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/bluemix-private-cloud" class="list--item__link">Legal</a>
      </li>
      <li class="list--item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/bluemix-private-cloud" class="list--item__link">Privacy Policy</a>
      </li>
      <li class="list--item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/bluemix-private-cloud" class="list--item__link">Terms and Conditions</a>
      </li>

    </ul>
  </div>
  <div class="footer__wrapper--black">
    <p>
        &copy; 2017 IBM Bluemix
    </p>
  </div>
</footer>



    <script src="/bluebox/help-documentation/js/vendor/simple-jekyll-search.js" type="text/javascript"></script>


    <script>
        SimpleJekyllSearch({
          searchInput: document.getElementById('search-input'),
          resultsContainer: document.getElementById('results-container'),
          json: '/bluebox/help-documentation/search.json',
          searchResultTemplate: '<li class="search-item"><a href="{url}" class="item-title">{title}</a><ul class="tag--list">{tags}</ul></li>'
        });
    </script>
  <script src="/bluebox/help-documentation/js/scripts.js"></script>

  </body>

</html>
